@import 'tailwindcss';
@import 'tw-animate-css';

/* Performance optimizations for instant loading */
* {
  /* Prevent layout shifts during hydration */
  box-sizing: border-box;
}

html {
  /* Prevent flash of unstyled content */
  visibility: visible;
  opacity: 1;
}

body {
  /* Ensure consistent rendering */
  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* Prevent layout shifts */
  overflow-x: hidden;
}

/* Prevent hydration layout shifts */
#__next {
  isolation: isolate;
}

/* Ensure all buttons show pointer cursor */
button:not(:disabled) {
  cursor: pointer;
}

button:disabled {
  cursor: not-allowed;
}

/* Optimize component rendering */
.flex {
  /* Prevent flex layout shifts */
  min-height: 0;
}

/* Prevent iframe loading flashes */
iframe {
  background-color: white;
}

/* Mobile viewport handling - Modern approach with fallbacks */
:root {
  /* Fallback for older browsers */
  --vh: 1vh;
  --vw: 1vw;
  
  /* Modern viewport units for mobile browsers */
  --dynamic-vh: 1dvh; /* Dynamic viewport height - adjusts with browser UI */
  --small-vh: 1svh;   /* Small viewport height - excludes browser UI */
  --large-vh: 1lvh;   /* Large viewport height - includes browser UI */
  
  /* Safe area insets for mobile devices */
  --safe-area-inset-top: env(safe-area-inset-top, 0px);
  --safe-area-inset-right: env(safe-area-inset-right, 0px);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-inset-left: env(safe-area-inset-left, 0px);
  
  /* Theme variables */
  --background: rgb(255, 255, 255);
  --foreground: rgb(10, 10, 10);
  --card: rgb(255, 255, 255);
  --card-foreground: rgb(10, 10, 10);
  --popover: rgb(255, 255, 255);
  --popover-foreground: rgb(10, 10, 10);
  --primary: rgb(41, 41, 41);
  --primary-foreground: rgb(250, 250, 250);
  --secondary: rgb(250, 250, 250);
  --secondary-foreground: rgb(90, 90, 90);
  --muted: rgb(240, 240, 240);
  --muted-foreground: rgb(113, 113, 113);
  --accent: rgb(245, 245, 245);
  --accent-foreground: oklch(57.61% 0.2508 258.23);
  --destructive: rgb(231, 0, 11);
  --destructive-foreground: rgb(245, 245, 245);
  --border: rgb(229, 229, 229);
  --input: rgb(229, 229, 229);
  --ring: rgb(161, 161, 161);
  --chart-1: rgb(115, 115, 115);
  --chart-2: rgb(115, 115, 115);
  --chart-3: rgb(115, 115, 115);
  --chart-4: rgb(115, 115, 115);
  --chart-5: rgb(115, 115, 115);
  --sidebar: rgb(250, 250, 250);
  --sidebar-foreground: rgb(10, 10, 10);
  --sidebar-primary: rgb(23, 23, 23);
  --sidebar-primary-foreground: rgb(250, 250, 250);
  --sidebar-accent: rgb(245, 245, 245);
  --sidebar-accent-foreground: rgb(23, 23, 23);
  --sidebar-border: rgb(229, 229, 229);
  --sidebar-ring: rgb(161, 161, 161);
  --font-sans: Geist, sans-serif;
  --font-serif: Geist Mono, monospace;
  --font-mono: Geist Mono, monospace;
  --radius: 0.75rem;
  --shadow-2xs: 0px 1px 0px 0px hsl(0 0% 0% / 0);
  --shadow-xs: 0px 1px 0px 0px hsl(0 0% 0% / 0);
  --shadow-sm: rgba(0, 0, 0, 0) 0px 0px 0px 0px,
    rgba(0, 0, 0, 0) 0px 0px 0px 0px, rgba(0, 0, 0, 0.08) 0px 0px 0px 1px,
    rgba(0, 0, 0, 0.04) 0px 2px 2px 0px,
    rgb(250, 250, 250) 0px 0px 0px 1px box-sizing;
  --shadow: 0 0 0 1px rgba(0, 0, 0, 0.08), 0px 1px 1px rgba(0, 0, 0, 0.02),
    0px 8px 16px -4px rgba(0, 0, 0, 0.04),
    0px 24px 32px -8px rgba(0, 0, 0, 0.06);
  --shadow-md: 0px 1px 0px 0px hsl(0 0% 0% / 0),
    0px 2px 4px -1px hsl(0 0% 0% / 0);
  --shadow-lg: 0px 1px 0px 0px hsl(0 0% 0% / 0),
    0px 4px 6px -1px hsl(0 0% 0% / 0);
  --shadow-xl: 0px 1px 0px 0px hsl(0 0% 0% / 0),
    0px 8px 10px -1px hsl(0 0% 0% / 0);
  --shadow-2xl: 0px 1px 0px 0px hsl(0 0% 0% / 0);
  --tracking-normal: 0em;
  --spacing: 0.25rem;
  --selection-bg: rgba(59, 130, 246, 0.3); /* Blue with transparency */
  --selection-color: inherit;
}

/* Mobile viewport height calculation */
.mobile-viewport-height {
  /* Fallback for browsers without dvh support */
  height: 100vh;
  height: calc(var(--vh, 1vh) * 100);
  
  /* Modern browsers with dynamic viewport support */
  height: 100dvh;
}

.mobile-max-viewport-height {
  /* Fallback for browsers without dvh support */
  max-height: 100vh;
  max-height: calc(var(--vh, 1vh) * 100);
  
  /* Modern browsers with dynamic viewport support */
  max-height: 100dvh;
}

/* Optimize mobile rendering */
@media (max-width: 1023px) {
  body {
    /* Prevent mobile viewport issues */
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
    
    /* Ensure body takes full viewport */
    min-height: 100vh;
    min-height: calc(var(--vh, 1vh) * 100);
    min-height: 100dvh;
  }
  
  /* Mobile-specific viewport handling */
  .mobile-container {
    height: 100vh;
    height: calc(var(--vh, 1vh) * 100);
    height: 100dvh;
    max-height: 100vh;
    max-height: calc(var(--vh, 1vh) * 100);
    max-height: 100dvh;
  }
  
  /* Ensure chat input stays visible */
  .chat-input-container {
    padding-bottom: var(--safe-area-inset-bottom);
    background: var(--background);
    position: sticky;
    bottom: 0;
    z-index: 50;
    border-top: 1px solid var(--border);
  }
  
  /* Mobile chat container specific styles */
  .mobile-chat-container {
    height: 100vh;
    height: calc(var(--vh, 1vh) * 100);
    height: 100dvh;
    max-height: 100vh;
    max-height: calc(var(--vh, 1vh) * 100);
    max-height: 100dvh;
    display: flex;
    flex-direction: column;
  }
  
  /* Ensure inputs with explicit font size classes work properly */
  input[class*="text-"], textarea[class*="text-"], select[class*="text-"] {
    font-size: inherit;
  }
}

/* Support for browsers without dvh */
@supports not (height: 100dvh) {
  .mobile-viewport-height {
    height: calc(var(--vh, 1vh) * 100);
  }
  
  .mobile-max-viewport-height {
    max-height: calc(var(--vh, 1vh) * 100);
  }
  
  .mobile-container {
    height: calc(var(--vh, 1vh) * 100);
    max-height: calc(var(--vh, 1vh) * 100);
  }
}

.dark {
  --background: rgb(10, 10, 10);
  --foreground: rgb(250, 250, 250);
  --card: rgb(25, 25, 25);
  --card-foreground: rgb(250, 250, 250);
  --popover: rgb(38, 38, 38);
  --popover-foreground: rgb(250, 250, 250);
  --primary: rgb(115, 115, 115);
  --primary-foreground: rgb(250, 250, 250);
  --secondary: rgb(38, 38, 38);
  --secondary-foreground: rgb(250, 250, 250);
  --muted: rgb(38, 38, 38);
  --muted-foreground: rgb(161, 161, 161);
  --accent: rgb(64, 64, 64);
  --accent-foreground: rgb(250, 250, 250);
  --destructive: rgb(255, 100, 103);
  --destructive-foreground: rgb(38, 38, 38);
  --border: rgb(56, 56, 56);
  --input: rgb(82, 82, 82);
  --ring: rgb(115, 115, 115);
  --chart-1: rgb(115, 115, 115);
  --chart-2: rgb(115, 115, 115);
  --chart-3: rgb(115, 115, 115);
  --chart-4: rgb(115, 115, 115);
  --chart-5: rgb(115, 115, 115);
  --sidebar: rgb(23, 23, 23);
  --sidebar-foreground: rgb(250, 250, 250);
  --sidebar-primary: rgb(250, 250, 250);
  --sidebar-primary-foreground: rgb(23, 23, 23);
  --sidebar-accent: rgb(38, 38, 38);
  --sidebar-accent-foreground: rgb(250, 250, 250);
  --sidebar-border: rgb(255, 255, 255);
  --sidebar-ring: rgb(82, 82, 82);
  --font-sans: Geist, sans-serif;
  --font-serif: Geist Mono, monospace;
  --font-mono: Geist Mono, monospace;
  --radius: 0.75rem;
  --shadow-2xs: 0px 1px 0px 0px hsl(0 0% 0% / 0);
  --shadow-xs: 0px 1px 0px 0px hsl(0 0% 0% / 0);
  --shadow-sm: 0px 1px 0px 0px hsl(0 0% 0% / 0),
    0px 1px 2px -1px hsl(0 0% 0% / 0);
  --shadow: 0px 1px 0px 0px hsl(0 0% 0% / 0), 0px 1px 2px -1px hsl(0 0% 0% / 0);
  --shadow-md: 0px 1px 0px 0px hsl(0 0% 0% / 0),
    0px 2px 4px -1px hsl(0 0% 0% / 0);
  --shadow-lg: 0px 1px 0px 0px hsl(0 0% 0% / 0),
    0px 4px 6px -1px hsl(0 0% 0% / 0);
  --shadow-xl: 0px 1px 0px 0px hsl(0 0% 0% / 0),
    0px 8px 10px -1px hsl(0 0% 0% / 0);
  --shadow-2xl: 0px 1px 0px 0px hsl(0 0% 0% / 0);
  --selection-bg: rgba(96, 165, 250, 0.4); /* Lighter blue for dark mode */
  --selection-color: inherit;
}

/* Text selection styling */
::selection {
  background-color: var(--selection-bg);
  color: var(--selection-color);
}

::-moz-selection {
  background-color: var(--selection-bg);
  color: var(--selection-color);
}

.welcome-mode {
  padding: 0 !important;
  gap: 0 !important;
}

@keyframes welcomeScreenFadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Smooth transitions for layout changes */
.transition-layout {
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);

  --font-sans: var(--font-sans);
  --font-mono: var(--font-mono);
  --font-serif: var(--font-serif);

  --radius-sm: calc(var(--radius) - 6px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);

  --shadow-2xs: var(--shadow-2xs);
  --shadow-xs: var(--shadow-xs);
  --shadow-sm: var(--shadow-sm);
  --shadow: var(--shadow);
  --shadow-md: var(--shadow-md);
  --shadow-lg: var(--shadow-lg);
  --shadow-xl: var(--shadow-xl);
  --shadow-2xl: var(--shadow-2xl);
}
